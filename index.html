
<head>
    <link rel="stylesheet" href="style.css">
  </head>
  <main>

 <div id="code"> 
<textArea class="list" id="count">1</textArea>
  <div class="container">

    <div class="backdrop">
      <div class="custom-area">
       
  
      </div>
    </div>

    <textarea id="myTextArea" onkeydown="if(event.keyCode===9){
      var v=this.value,
      s=this.selectionStart,
      e=this.selectionEnd;
  
      this.value=v.substring(0, s)+'\t'+v.substring(e);this.selectionStart=this.selectionEnd=s+1;
      return false;
    }
      var count = document.getElementById('count');
      var count1 = document.getElementById('myTextArea')
      var nb=1;
       if((count1.selectionStart!=null)&&(count1.selectionStart!=undefined))
var position = count1.selectionStart;
       for(let i = 0; i<=this.value.length; i++)
      if(this.value[i] == '\n')nb++;
    
     if((event.keyCode === 13)){
      
      if(nb == 1) nb=2;
      else nb+=1
    count.value = count.value+'\n'+nb.toString();
}
"  onkeyup ="
      var count = document.getElementById('count');
      var count1 = document.getElementById('myTextArea')
      var nb=1;
          for(let i = 0; i<=this.value.length; i++)
      if(this.value[i] == '\n')nb++;
    console.log(nb);
    if(event.keyCode == 8){
      if(nb >= 9){
        var last_line = count.value.substring(count.value.length -2);
        if (nb < parseInt(last_line)){
            count.value = count.value.substring(0, count.value.length -3);
        }
      }
      else if(nb < parseInt(count.value.substring(count.value.length -2)))
        count.value = count.value.substring(0, count.value.length -2);
    }
"></textarea>

  </div>
</div>
  
  </main> 

<script>


  let registers = /\bAX[^a-z0-9]|\bBX[^a-z0-9]|\bCX[^a-z0-9]|\bDX[^a-z0-9]|\bCS[^a-z0-9]|\bDS[^a-z0-9]|\bES[^a-z0-9]|\bSS[^a-z0-9]|\bDI[^a-z0-9]|\bSI[^a-z0-9]|\bSP[^a-z0-9]|\bBP[^a-z0-9]|\bIP[^a-z0-9]/ig
  let re = /(;.*ax)/igy

let directives = /\bORG[^a-z0-9]|\bDEFINE[^a-z0-9]|\bEQU[^a-z0-9]|\bPROC[^a-z0-9]|\bLOCAL[^a-z0-9]|\bENDM[^a-z0-9]|\bENDP[^a-z0-9]|\bOFFSET[^a-z0-9]/gi

var instructions = /\bMOV[^a-z0-9]|\bPUSH[^a-z0-9]|\bPOP[^a-z0-9]|\bXCHG[^a-z0-9]|\bLEA[^a-z0-9]|\bLAHF[^a-z0-9]|\bSAHF[^a-z0-9]|\bPUSHF[^a-z0-9]|\bPOPF[^a-z0-9]|\bADD[^a-z0-9]|\bADC[^a-z0-9]|\bDEC[^a-z0-9]|\bINC[^a-z0-9]|\bAAA[^a-z0-9]|\bSUB[^a-z0-9]|\bSSB[^a-z0-9]|\bNEG[^a-z0-9]|\bCMP[^a-z0-9]|\bMUL[^a-z0-9]|\bIMUL[^a-z0-9]|\bDIV[^a-z0-9]|\bIDIV[^a-z0-9]|\bCBW[^a-z0-9]|\bCWD[^a-z0-9]|\bNOT[^a-z0-9]|\bSHL[^a-z0-9]|\bSAL[^a-z0-9]|\bSHR[^a-z0-9]|\bSAR[^a-z0-9]|\bROL[^a-z0-9]|\bROR[^a-z0-9]|\bRCL[^a-z0-9]|\bRCR[^a-z0-9]|\bAND[^a-z0-9]|\bTEST[^a-z0-9]|\bOR[^a-z0-9]|\bXOR[^a-z0-9]|\bREP[^a-z0-9]|\bMOVSB[^a-z0-9]|\bCMPSB[^a-z0-9]|\bSCASB[^a-z0-9]|\bLODSB[^a-z0-9]|\bSTOSB[^a-z0-9]|\bMOVSW[^a-z0-9]|\bCMPSW[^a-z0-9]|\bSCASW[^a-z0-9]|\bLODSW[^a-z0-9]|\bSTOSW[^a-z0-9]|\bCALL[^a-z0-9]|\bJMP[^a-z0-9]|\bRET[^a-z0-9]|\bJE[^a-z0-9]|\bJZ[^a-z0-9]|\bJL[^a-z0-9]|\bJNGE[^a-z0-9]|\bJLE[^a-z0-9]|\bJNG[^a-z0-9]|\bJB[^a-z0-9]|\bJNAE[^a-z0-9]|\bJBE[^a-z0-9]|\bJNA[^a-z0-9]|\bJP[^a-z0-9]|\bJPE[^a-z0-9]|\bJO[^a-z0-9]|\bJS[^a-z0-9]|\bJNE[^a-z0-9]|\bJNZ[^a-z0-9]|\bJNL[^a-z0-9]|\bJGE[^a-z0-9]|\bJNLE[^a-z0-9]|\bJG[^a-z0-9]|\bJNB[^a-z0-9]|\bJAE[^a-z0-9]|\bJNBE[^a-z0-9]|\bJA[^a-z0-9]|\bJNP[^a-z0-9]|\bJPO[^a-z0-9]|\bJNO[^a-z0-9]|\bJNS[^a-z0-9]|\bLOOP[^a-z0-9]|\bLOOPZ[^a-z0-9]|\bLOOPE[^a-z0-9]|\bLOOPNZ[^a-z0-9]|\bLOOPNE[^a-z0-9]|\bJCXZ[^a-z0-9]|\bINT[^a-z0-9]/ig





let textArea = document.getElementById("myTextArea");
let customArea = document.querySelector(".custom-area");
let backdrop = document.querySelector(".backdrop");
let count = document.getElementById("count");


// Event listeners.

textArea.addEventListener("input", function(e)
{

  customArea.innerHTML =applyColors(textArea.value)

  console.log(getText(textArea.value))

    })

var s1 = document.getElementById('myTextArea');
var s2 = document.getElementById('count');

function select_scroll_1(e) { s2.scrollTop = s1.scrollTop; }
function select_scroll_2(e) { s1.scrollTop = s2.scrollTop; }

s1.addEventListener('scroll', select_scroll_1, false);
s2.addEventListener('scroll', select_scroll_2, false);

textArea.addEventListener("scroll", function()
{
    backdrop.scrollTop = textArea.scrollTop;
});


function applyColors(text)

{



return text.replace(registers, function(m)
    {  
      //console.log(all_regex)
      let c = "orange"
   
        return `<span class="re">${m}</span>`;
    }).replace(directives, function(m){

       let c = "cyan"
   
        return `<span class="dir">${m}</span>`;

    }).replace(instructions, function(m){
      let c = "violet"
   
        return `<span class="ins">${m}</span>`;

    }).replace(/(\;(.*)\n?)/gi, function(m){
      let c = "yellow"
       if(m.match(/\;{1,}<span class="ins">/giy)) m = m.replaceAll(/<span class="ins">/gi,`<span class="comments">`)
       if(m.match(/\;{1,}<span class="re">/giy)) m = m.replaceAll(/<span class="re">/gi,`<span class="comments">`)
       if(m.match(/\;{1,}<span class="dir">/giy)) m = m.replaceAll(/<span class="dir">/gi,`<span class="comments">`)
       
       if(m.match(/\s*<span class="ins">/gi)) {
        
        m = m.replaceAll(/<span class="ins">/gi,`<span class="comments">`)}
        if(m.match(/\s*<span class="re">/gi)) m = m.replaceAll(/<span class="re">/gi,`<span class="comments">`)
          if(m.match(/\s*<span class="dir">/gi)) m = m.replaceAll(/<span class="dir">/gi,`<span class="comments">`)

  
      
        return `<span class="comments">${m}</span>`;
        }).replace(/\'(.*)'/gi, function(m){


          if(m.match(/\'{1,}<span class="ins">/giy)) m = m.replaceAll(/<span class="ins">/gi,`<span class="strings">`)
       if(m.match(/\'{1,}<span class="re">/giy)) m = m.replaceAll(/<span class="re">/gi,`<span class="strings">`) 
        
       if(m.match(/\'{1,}<span class="dir">/giy)) m = m.replaceAll(/<span class="dir">/gi,`<span class="strings">`)

       if(m.match(/\s*<span class="ins">/gi)) m = m.replaceAll(/<span class="ins">/gi,`<span class="strings">`)
        if(m.match(/\s*<span class="re">/gi)) m = m.replaceAll(/<span class="re">/gi,`<span class="strings">`)
          if(m.match(/\s*<span class="dir">/gi)) m = m.replac
          return `<span class="strings">${m}</span>`;
        }).replace(/0x[0-9a-f]+|[a-f0-9]+h|0b[0-1]+|\d+/gi, function(m){
      
         return `<span class="digit">${m}</span>`
    })
}


function getText(text){
  text  = text.replace(/<span .+>/, '').replace(/<\/span>/, '');
  return text;
}

</script>
